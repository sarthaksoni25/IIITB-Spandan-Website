/*!
 * froala_editor v2.0.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms
 * Copyright 2014-2015 Froala Labs
 */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,l){return void 0===l&&(l="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(l),l}:e(jQuery)}(function(e){"use strict";e.extend(e.FroalaEditor.POPUP_TEMPLATES,{"table.insert":"[_BUTTONS_][_ROWS_COLUMNS_]","table.edit":"[_BUTTONS_]","table.colors":"[_BUTTONS_][_COLORS_]"}),e.extend(e.FroalaEditor.DEFAULTS,{tableInsertMaxSize:10,tableEditButtons:["tableHeader","tableRemove","|","tableRows","tableColumns","tableStyle","-","tableCells","tableCellBackground","tableCellVerticalAlign","tableCellHorizontalAlign","tableCellStyle"],tableInsertButtons:["tableBack","|"],tableResizerOffset:5,tableResizingLimit:30,tableColorsButtons:["tableBack","|"],tableColors:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],tableColorsStep:7,tableCellStyles:{"fr-highlighted":"Highlighted","fr-thick":"Thick"},tableStyles:{"fr-dashed-borders":"Dashed Borders","fr-alternate-rows":"Alternate Rows"},tableCellMultipleStyles:!0,tableMultipleStyles:!0}),e.FroalaEditor.PLUGINS.table=function(t){function l(){var e=t.$tb.find('.fr-command[data-cmd="insertTable"]'),l=t.popups.get("table.insert");if(l||(l=i()),!l.hasClass("fr-active")){t.popups.refresh("table.insert"),t.popups.setContainer("table.insert",t.$tb);var a=e.offset().left+e.outerWidth()/2,o=e.offset().top+(t.opts.toolbarBottom?10:e.outerHeight()-10);t.popups.show("table.insert",a,o,e.outerHeight())}}function a(){var l=R();if(l){var a=t.popups.get("table.edit");a||(a=s()),t.popups.setContainer("table.edit",e(t.opts.scrollableContainer));var o=k(l),r=(o.left+o.right)/2,i=o.bottom;if(t.popups.show("table.edit",r,i,o.bottom-o.top),t.$el.find(".fr-selected-cell").length>1){t.toolbar.disable(),t.$el.removeClass("fr-no-selection"),t.edit.on();var n=e(t.original_window).scrollTop();t.$el.focus(),t.selection.setAtEnd(t.$el.find(".fr-selected-cell:last").get(0)),t.selection.restore(),e(t.original_window).scrollTop(n),t.button.bulkRefresh()}}}function o(){var l=R();if(l){var a=t.popups.get("table.colors");a||(a=d()),t.popups.setContainer("table.colors",e(t.opts.scrollableContainer));var o=k(l),r=(o.left+o.right)/2,i=o.bottom;c(),t.popups.show("table.colors",r,i,o.bottom-o.top)}}function r(){0===t.$el.get(0).querySelectorAll(".fr-selected-cell").length&&t.toolbar.enable()}function i(){var l="";t.opts.tableInsertButtons.length>0&&(l='<div class="fr-buttons">'+t.button.buildList(t.opts.tableInsertButtons)+"</div>");var a={buttons:l,rows_columns:n()},o=t.popups.create("table.insert",a);return t.popups.onHide("table.insert",function(){o.find('.fr-table-size .fr-select-table-size > span[data-row="1"][data-col="1"]').trigger("mouseenter")}),o.on("mouseenter",".fr-table-size .fr-select-table-size .fr-table-cell",function(l){var a=e(l.currentTarget),o=a.data("row"),r=a.data("col"),i=a.parent();i.siblings(".fr-table-size-info").html(o+" &times; "+r),i.find("> span").removeClass("hover");for(var n=1;n<=t.opts.tableInsertMaxSize;n++)for(var s=0;s<=t.opts.tableInsertMaxSize;s++){var d=i.find('> span[data-row="'+n+'"][data-col="'+s+'"]');o>=n&&r>=s?d.addClass("hover"):o+1>=n||2>=n&&!t.helpers.isMobile()?d.css("display","inline-block"):n>2&&!t.helpers.isMobile()&&d.css("display","none")}}),t.events.on("destroy",function(){o.off("mouseenter",".fr-table-size .fr-select-table-size .fr-table-cell")},!0),o}function n(){for(var e='<div class="fr-table-size"><div class="fr-table-size-info">1 &times; 1</div><div class="fr-select-table-size">',l=1;l<=t.opts.tableInsertMaxSize;l++){for(var a=1;a<=t.opts.tableInsertMaxSize;a++){var o="inline-block";l>2&&!t.helpers.isMobile()&&(o="none");var r="fr-table-cell ";1==l&&1==a&&(r+=" hover"),e+='<span class="fr-command '+r+'" data-cmd="tableInsert" data-row="'+l+'" data-col="'+a+'" data-param1="'+l+'" data-param2="'+a+'" style="display: '+o+';"><span></span></span>'}e+='<div class="new-line"></div>'}return e+="</div></div>"}function s(){var e="";t.opts.tableEditButtons.length>0&&(e='<div class="fr-buttons">'+t.button.buildList(t.opts.tableEditButtons)+"</div>");var l={buttons:e},o=t.popups.create("table.edit",l);return t.popups.onHide("table.edit",r),t.$wp.on("scroll.table-edit",function(){t.popups.isVisible("table.edit")&&a()}),t.events.on("destroy",function(){t.$wp.off("scroll.table-edit")}),o}function d(){var e="";t.opts.tableColorsButtons.length>0&&(e='<div class="fr-buttons fr-table-colors-buttons">'+t.button.buildList(t.opts.tableColorsButtons)+"</div>");var l={buttons:e,colors:f()},a=t.popups.create("table.colors",l);return t.$wp.on("scroll.table-colors",function(){t.popups.isVisible("table.colors")&&o()}),t.events.on("destroy",function(){t.$wp.off("scroll.table-colors")}),a}function f(){for(var e='<div class="fr-table-colors">',l=0;l<t.opts.tableColors.length;l++)0!==l&&l%t.opts.tableColorsStep===0&&(e+="<br>"),e+="REMOVE"!=t.opts.tableColors[l]?'<span class="fr-command" style="background: '+t.opts.tableColors[l]+';" data-cmd="tableCellBackgroundColor" data-param1="'+t.opts.tableColors[l]+'"></span>':'<span class="fr-command" data-cmd="tableCellBackgroundColor" data-param1="REMOVE" title="'+t.language.translate("Clear Formatting")+'"><i class="fa fa-eraser"></i></span>';return e+="</div>"}function c(){var e=t.popups.get("table.colors"),l=t.$el.find(".fr-selected-cell:first");e.find(".fr-selected-color").removeClass("fr-selected-color"),e.find('span[data-param1="'+t.helpers.RGBToHex(l.css("background-color"))+'"]').addClass("fr-selected-color")}function p(l,a){var o,r,i='<table style="width: 100%;"><tbody>',n=100/a;for(o=0;l>o;o++){for(i+="<tr>",r=0;a>r;r++)i+='<td style="width: '+n.toFixed(4)+'%;">',0===o&&0===r&&(i+=e.FroalaEditor.MARKERS),i+="<br></td>";i+="</tr>"}i+="</tbody></table>",t.html.insert(i),t.selection.restore()}function h(){if(t.$el.find(".fr-selected-cell").length>0){var e=t.$el.find(".fr-selected-cell").closest("table");t.selection.setBefore(e.get(0))||t.selection.setAfter(e.get(0)),t.selection.restore(),t.popups.hide("table.edit"),e.remove()}}function u(){var l=t.$el.find(".fr-selected-cell").closest("table");if(l.length>0&&0===l.find("th").length){var o,r="<thead><tr>",i=0;for(l.find("tr:first > td").each(function(){var t=e(this);i+=parseInt(t.attr("colspan"),10)||1}),o=0;i>o;o++)r+="<th><br></th>";r+="</tr></thead>",l.prepend(r),a()}}function b(){var e=t.$el.find(".fr-selected-cell").closest("table"),l=e.find("thead");if(l.length>0)if(0===e.find("tbody tr").length)h();else if(l.remove(),t.$el.find(".fr-selected-cell").length>0)a();else{t.popups.hide("table.edit");var o=e.find("tbody tr:first td:first").get(0);o&&(t.selection.setAtEnd(o),t.selection.restore())}}function m(l){var o=t.$el.find(".fr-selected-cell").closest("table");if(o.length>0){if(t.$el.find("th.fr-selected-cell").length>0&&"above"==l)return;var r,i,n=R(),s=D(n);i="above"==l?s.min_i:s.max_i;var d="<tr>";for(r=0;r<n[i].length;r++)if("below"==l&&i<n.length-1&&n[i][r]==n[i+1][r]||"above"==l&&i>0&&n[i][r]==n[i-1][r]){if(0===r||r>0&&n[i][r]!=n[i][r-1]){var f=e(n[i][r]);f.attr("rowspan",parseInt(f.attr("rowspan"),10)+1)}}else d+="<td><br></td>";d+="</tr>";var c=e(o.find("tr").not(o.find("table tr")).get(i));"below"==l?c.after(d):"above"==l&&(c.before(d),a())}}function g(){var l=t.$el.find(".fr-selected-cell").closest("table");if(l.length>0){var a,o,r,i=R(),n=D(i);if(0===n.min_i&&n.max_i==i.length-1)h();else{for(a=n.max_i;a>=n.min_i;a--){for(r=e(l.find("tr").not(l.find("table tr")).get(a)),o=0;o<i[a].length;o++)if(0===o||i[a][o]!=i[a][o-1]){var s=e(i[a][o]);if(parseInt(s.attr("rowspan"),10)>1){var d=parseInt(s.attr("rowspan"),10)-1;1==d?s.removeAttr("rowspan"):s.attr("rowspan",d)}if(a<i.length-1&&i[a][o]==i[a+1][o]&&(0===a||i[a][o]!=i[a-1][o])){for(var f=i[a][o],c=o;c>0&&i[a][c]==i[a][c-1];)c--;0===c?e(l.find("tr").not(l.find("table tr")).get(a+1)).prepend(f):e(i[a+1][c-1]).after(f)}}var p=r.parent();r.remove(),0===p.find("tr").length&&p.remove(),i=R(l)}n.min_i>0?t.selection.setAtEnd(i[n.min_i-1][0]):t.selection.setAtEnd(i[0][0]),t.selection.restore(),t.popups.hide("table.edit")}}}function v(l){var o=t.$el.find(".fr-selected-cell").closest("table");if(o.length>0){var r,i=R(),n=D(i);r="before"==l?n.min_j:n.max_j;var s,d=100/i[0].length,f=100/(i[0].length+1);o.find("th, td").each(function(){s=e(this),s.data("old-width",s.outerWidth()/o.outerWidth()*100)}),o.find("tr").not(o.find("table tr")).each(function(t){for(var a,o=e(this),n=0,s=0;r>n-1;){if(a=o.find("> th, > td").get(s),!a){a=null;break}a==i[t][n]?(n+=parseInt(e(a).attr("colspan"),10)||1,s++):(n+=parseInt(e(i[t][n]).attr("colspan"),10)||1,"after"==l&&(a=0===s?-1:o.find("> th, > td").get(s-1)))}var c=e(a);if("after"==l&&n-1>r||"before"==l&&r>0&&i[t][r]==i[t][r-1]){if(0===t||t>0&&i[t][r]!=i[t-1][r]){var p=parseInt(c.attr("colspan"),10)+1;c.attr("colspan",p),c.css("width",(c.data("old-width")*f/d+f).toFixed(4)+"%"),c.removeData("old-width")}}else{var h;h=o.find("th").length>0?'<th style="width: '+f.toFixed(4)+'%;"><br></th>':'<td style="width: '+f.toFixed(4)+'%;"><br></td>',-1==a?o.prepend(h):null==a?o.append(h):"before"==l?c.before(h):"after"==l&&c.after(h)}}),o.find("th, td").each(function(){s=e(this),s.data("old-width")&&(s.css("width",(s.data("old-width")*f/d).toFixed(4)+"%"),s.removeData("old-width"))}),a()}}function w(){var l=t.$el.find(".fr-selected-cell").closest("table");if(l.length>0){var a,o,r,i=R(),n=D(i);if(0===n.min_j&&n.max_j==i[0].length-1)h();else{var s=100/i[0].length,d=100/(i[0].length-n.max_j+n.min_j-1);for(l.find("th, td").each(function(){r=e(this),r.hasClass("fr-selected-cell")||r.data("old-width",r.outerWidth()/l.outerWidth()*100)}),o=n.max_j;o>=n.min_j;o--)for(a=0;a<i.length;a++)if(0===a||i[a][o]!=i[a-1][o])if(r=e(i[a][o]),parseInt(r.attr("colspan"),10)>1){var f=parseInt(r.attr("colspan"),10)-1;1==f?r.removeAttr("colspan"):r.attr("colspan",f),r.css("width",((r.data("old-width")-K(o,i))*d/s).toFixed(4)+"%"),r.removeData("old-width")}else{var c=e(r.parent().get(0));r.remove(),0===c.find("> th, > td").length&&(0===c.prev().length||0===c.next().length||c.prev().find("> th[rowspan], > td[rowspan]").length<c.prev().find("> th, > td").length)&&c.remove()}n.min_j>0?t.selection.setAtEnd(i[n.min_i][n.min_j-1]):t.selection.setAtEnd(i[n.min_i][0]),t.selection.restore(),t.popups.hide("table.edit"),l.find("th, td").each(function(){r=e(this),r.data("old-width")&&(r.css("width",(r.data("old-width")*d/s).toFixed(4)+"%"),r.removeData("old-width"))})}}}function C(){if(t.$el.find(".fr-selected-cell").length>1&&(0===t.$el.find("th.fr-selected-cell").length||0===t.$el.find("td.fr-selected-cell").length)){var l,o,r,i=R(),n=D(i),s=t.$el.find(".fr-selected-cell"),d=e(s[0]),f=d.parent(),c=f.find(".fr-selected-cell"),p=d.closest("table"),h=d.html(),u=0;for(l=0;l<c.length;l++)u+=e(c[l]).outerWidth();for(d.css("width",(u/f.outerWidth()*100).toFixed(4)+"%"),n.min_j<n.max_j&&d.attr("colspan",n.max_j-n.min_j+1),n.min_i<n.max_i&&d.attr("rowspan",n.max_i-n.min_i+1),l=1;l<s.length;l++)o=e(s[l]),"<br>"!=o.html()&&""!==o.html()&&(h+="<br>"+o.html()),o.remove();d.html(h),t.selection.setAtEnd(d.get(0)),t.selection.restore(),t.toolbar.enable();var b=p.find("tr:empty");for(l=b.length-1;l>=0;l--)r=e(b[l]),(0===r.prev().length||0===r.next().length||r.prev().find("> th[rowspan], > td[rowspan]").length<r.prev().find("> th, > td").length)&&r.remove();a()}}function E(){if(1==t.$el.find(".fr-selected-cell").length){var l=t.$el.find(".fr-selected-cell"),a=l.parent(),o=l.closest("table"),r=parseInt(l.attr("rowspan"),10),i=R(),n=x(l.get(0),i),s=l.clone().html("<br>");if(r>1){var d=Math.ceil(r/2);d>1?l.attr("rowspan",d):l.removeAttr("rowspan"),r-d>1?s.attr("rowspan",r-d):s.removeAttr("rowspan");for(var f=n.row+d,c=0===n.col?n.col:n.col-1;c>=0&&(i[f][c]==i[f][c-1]||f>0&&i[f][c]==i[f-1][c]);)c--;-1==c?e(o.find("tr").not(o.find("table tr")).get(f)).prepend(s):e(i[f][c]).after(s)}else{var p,h=e("<tr>").append(s);for(p=0;p<i[0].length;p++)if(0===p||i[n.row][p]!=i[n.row][p-1]){var u=e(i[n.row][p]);u.is(l)||u.attr("rowspan",(parseInt(u.attr("rowspan"),10)||1)+1)}a.after(h)}I(),t.popups.hide("table.edit")}}function $(){if(1==t.$el.find(".fr-selected-cell").length){var l=t.$el.find(".fr-selected-cell"),a=parseInt(l.attr("colspan"),10)||1,o=l.parent().outerWidth(),r=l.outerWidth(),i=l.clone().html("<br>"),n=R(),s=x(l.get(0),n);if(a>1){var d=Math.ceil(a/2);r=X(s.col,s.col+d-1,n)/o*100;var f=X(s.col+d,s.col+a-1,n)/o*100;d>1?l.attr("colspan",d):l.removeAttr("colspan"),a-d>1?i.attr("colspan",a-d):i.removeAttr("colspan"),l.css("width",r.toFixed(4)+"%"),i.css("width",f.toFixed(4)+"%")}else{var c;for(c=0;c<n.length;c++)if(0===c||n[c][s.col]!=n[c-1][s.col]){var p=e(n[c][s.col]);if(!p.is(l)){var h=(parseInt(p.attr("colspan"),10)||1)+1;p.attr("colspan",h)}}r=r/o*100/2,l.css("width",r.toFixed(4)+"%"),i.css("width",r.toFixed(4)+"%")}l.after(i),I(),t.popups.hide("table.edit")}}function y(e){"REMOVE"!=e?t.$el.find(".fr-selected-cell").css("background-color",t.helpers.HEXtoRGB(e)):t.$el.find(".fr-selected-cell").css("background-color","")}function F(e){t.$el.find(".fr-selected-cell").css("vertical-align",e)}function A(e){t.$el.find(".fr-selected-cell").css("text-align",e)}function M(e,t,l,a){if(t.length>0){if(!l){var o=Object.keys(a);o.splice(o.indexOf(e),1),t.removeClass(o.join(" "))}t.toggleClass(e)}}function R(l){l=l||null;var a=[];if(null==l&&t.$el.find(".fr-selected-cell").length>0&&(l=t.$el.find(".fr-selected-cell").closest("table")),l){var o=e(l);return o.find("tr").not(o.find("table tr")).each(function(t,l){var o=e(l),r=0;o.find("> th, > td").each(function(l,o){for(var i=e(o),n=parseInt(i.attr("colspan"),10)||1,s=parseInt(i.attr("rowspan"),10)||1,d=t;t+s>d;d++)for(var f=r;r+n>f;f++)a[d]||(a[d]=[]),a[d][f]?r++:a[d][f]=o;r+=n})}),a}}function x(e,t){for(var l=0;l<t.length;l++)for(var a=0;a<t[l].length;a++)if(t[l][a]==e)return{row:l,col:a}}function _(e,t,l){for(var a=e+1,o=t+1;a<l.length;){if(l[a][t]!=l[e][t]){a--;break}a++}for(a==l.length&&a--;o<l[e].length;){if(l[e][o]!=l[e][t]){o--;break}o++}return o==l[e].length&&o--,{row:a,col:o}}function I(){var l=t.$el.find(".fr-selected-cell");l.length>0&&l.each(function(){var t=e(this);t.removeClass("fr-selected-cell"),""===t.attr("class")&&t.removeAttr("class")})}function S(){setTimeout(function(){t.selection.clear(),t.$el.addClass("fr-no-selection"),t.edit.off(),t.$el.blur()},0)}function D(e){var l,a=e.length,o=0,r=e[0].length,i=0,n=t.$el.find(".fr-selected-cell");for(l=0;l<n.length;l++){var s=x(n[l],e),d=_(s.row,s.col,e);a=Math.min(s.row,a),o=Math.max(d.row,o),r=Math.min(s.col,r),i=Math.max(d.col,i)}return{min_i:a,max_i:o,min_j:r,max_j:i}}function z(t,l,a,o,r){var i,n,s,d,f=t,c=l,p=a,h=o;for(i=f;c>=i;i++)((parseInt(e(r[i][p]).attr("rowspan"),10)||1)>1||(parseInt(e(r[i][p]).attr("colspan"),10)||1)>1)&&(s=x(r[i][p],r),d=_(s.row,s.col,r),f=Math.min(s.row,f),c=Math.max(d.row,c),p=Math.min(s.col,p),h=Math.max(d.col,h)),((parseInt(e(r[i][h]).attr("rowspan"),10)||1)>1||(parseInt(e(r[i][h]).attr("colspan"),10)||1)>1)&&(s=x(r[i][h],r),d=_(s.row,s.col,r),f=Math.min(s.row,f),c=Math.max(d.row,c),p=Math.min(s.col,p),h=Math.max(d.col,h));for(n=p;h>=n;n++)((parseInt(e(r[f][n]).attr("rowspan"),10)||1)>1||(parseInt(e(r[f][n]).attr("colspan"),10)||1)>1)&&(s=x(r[f][n],r),d=_(s.row,s.col,r),f=Math.min(s.row,f),c=Math.max(d.row,c),p=Math.min(s.col,p),h=Math.max(d.col,h)),((parseInt(e(r[c][n]).attr("rowspan"),10)||1)>1||(parseInt(e(r[c][n]).attr("colspan"),10)||1)>1)&&(s=x(r[c][n],r),d=_(s.row,s.col,r),f=Math.min(s.row,f),c=Math.max(d.row,c),p=Math.min(s.col,p),h=Math.max(d.col,h));return f==t&&c==l&&p==a&&h==o?{min_i:t,max_i:l,min_j:a,max_j:o}:z(f,c,p,h,r)}function k(t){var l=D(t),a=e(t[l.min_i][l.min_j]),o=e(t[l.min_i][l.max_j]),r=e(t[l.max_i][l.min_j]),i=a.offset().left,n=o.offset().left+o.outerWidth(),s=a.offset().top,d=r.offset().top+r.outerHeight();return{left:i,right:n,top:s,bottom:d}}function O(t,l){if(e(t).is(l))I(),e(t).addClass("fr-selected-cell");else{S();var a=R(),o=x(t,a),r=x(l,a),i=z(Math.min(o.row,r.row),Math.max(o.row,r.row),Math.min(o.col,r.col),Math.max(o.col,r.col),a);I();for(var n=i.min_i;n<=i.max_i;n++)for(var s=i.min_j;s<=i.max_j;s++)e(a[n][s]).addClass("fr-selected-cell")}}function B(l){var a=null,o=e(l.target);return"TD"==l.target.tagName||"TH"==l.target.tagName?a=l.target:o.closest("td").length>0?a=o.closest("td").get(0):o.closest("th").length>0&&(a=o.closest("th").get(0)),0===t.$el.find(a).length?null:a}function T(l){if(t.$el.find(".fr-selected-cell").length>0&&!l.shiftKey&&(I(),t.$el.removeClass("fr-no-selection"),t.edit.on()),1==l.which){var a=B(l);if(a){t.popups.hide("table.edit"),l.stopPropagation(),t.events.trigger("image.hideResizer"),t.events.trigger("video.hideResizer"),Z=!0;var o=a.tagName.toLowerCase();l.shiftKey&&e(o+".fr-selected-cell").length>0?e(e(o+".fr-selected-cell").closest("table")).is(e(a).closest("table"))?O(ee,a):S():((t.keys.ctrlKey(l)||l.shiftKey)&&S(),ee=a,O(ee,ee))}}}function N(l){if(1==l.which){if(Z){Z=!1;var o=B(l);o||1!=t.$el.find(".fr-selected-cell").length?t.$el.find(".fr-selected-cell").length>0&&(t.selection.isCollapsed()?a():I()):I()}else t.$tb.is(l.target)||t.$tb.is(e(l.target).closest(t.$tb.get(0)))||(t.$el.get(0).querySelectorAll(".fr-selected-cell").length>0&&t.toolbar.enable(),I());if(le){le=!1,Q.removeClass("fr-moving"),t.$el.removeClass("fr-no-selection"),t.edit.on(),Q.find("div").css("opacity",0),Q.hide();var r=parseFloat(Q.css("left"))+t.opts.tableResizerOffset;t.opts.iframe&&(r-=t.$iframe.offset().left),Q.data("release-position",r),Q.removeData("max-left"),Q.removeData("max-right"),P(l)}}}function j(l){if(Z===!0){var a=e(l.currentTarget);if(a.closest("table").is(t.$el.find(".fr-selected-cell").closest("table"))){if("TD"==l.currentTarget.tagName&&0===t.$el.find("th.fr-selected-cell").length)return void O(ee,l.currentTarget);if("TH"==l.currentTarget.tagName&&0===t.$el.find("td.fr-selected-cell").length)return void O(ee,l.currentTarget)}S()}}function H(e){(37==e.which||38==e.which||39==e.which||40==e.which)&&t.$el.find(".fr-selected-cell").length>0&&(I(),t.popups.hide("table.edit"))}function W(){Q=e('<div class="fr-table-resizer"><div></div></div>'),t.$wp.append(Q),Q.on("mousedown",function(){le=!0,Q.addClass("fr-moving"),I(),S(),Q.find("div").css("opacity",1)}),t.events.on("destroy",function(){Q.off("mousedown"),Q.html("").removeData().remove()},!0)}function L(l){te=null;var a=t.document.elementFromPoint(l.pageX-t.window.pageXOffset,l.pageY-t.window.pageYOffset),o=e(a);if(a&&"TD"!=a.tagName&&"TH"!=a.tagName&&(o.closest("td").length>0?a=o.closest("td"):o.closest("th").length>0&&(a=o.closest("th"))),a&&("TD"==a.tagName||"TH"==a.tagName)){if(o=e(a),0===t.$el.find(o).length)return!1;var r=o.offset().left-1,i=r+o.outerWidth();if(Math.abs(l.pageX-r)<=t.opts.tableResizerOffset||Math.abs(i-l.pageX)<=t.opts.tableResizerOffset){var n,s,d,f,c,p=R(o.closest("table")),h=x(a,p),u=_(h.row,h.col,p),b=o.closest("table"),m=b.offset().top,g=b.outerHeight()-1;if(l.pageX-r<=t.opts.tableResizerOffset)if(d=r,h.col>0&&p[h.row][h.col-1]){var v=e(p[h.row][h.col-1]);f=1==(parseInt(v.attr("colspan"),10)||1)?v.offset().left-1+t.opts.tableResizingLimit:r-K(h.col-1,p)+t.opts.tableResizingLimit,c=1==(parseInt(o.attr("colspan"),10)||1)?r+o.outerWidth()-t.opts.tableResizingLimit:r+K(h.col,p)-t.opts.tableResizingLimit,n=h.col-1,s=h.col}else n=null,s=h.col,f=b.parent().offset().left+parseFloat(b.parent().css("padding-left")),c=b.offset().left-1+b.outerWidth()-p[0].length*t.opts.tableResizingLimit;else if(i-l.pageX<=t.opts.tableResizerOffset)if(d=i,u.col<p[u.row].length&&p[u.row][u.col+1]){var w=e(p[u.row][u.col+1]);f=1==(parseInt(o.attr("colspan"),10)||1)?r+t.opts.tableResizingLimit:i-K(u.col,p)+t.opts.tableResizingLimit,c=1==(parseInt(w.attr("colspan"),10)||1)?i+w.outerWidth()-t.opts.tableResizingLimit:i+K(h.col+1,p)-t.opts.tableResizingLimit,n=u.col,s=u.col+1}else{n=u.col,s=null;var C=b.parent();f=b.offset().left-1+p[0].length*t.opts.tableResizingLimit,c=C.offset().left-1+C.width()+parseFloat(C.css("padding-left"))}Q.data("table",b),Q.data("first",n),Q.data("second",s);var E=d-t.window.pageXOffset-t.opts.tableResizerOffset,$=m-t.window.pageYOffset;t.opts.iframe&&(E+=t.$iframe.offset().left-e(t.original_window).scrollLeft(),$+=t.$iframe.offset().top-e(t.original_window).scrollTop(),f+=t.$iframe.offset().left,c+=t.$iframe.offset().left),Q.data("max-left",f),Q.data("max-right",c),Q.data("origin",d-t.window.pageXOffset),Q.css("top",$),Q.css("left",E),Q.css("height",g),Q.find("div").css("height",g),Q.css("padding-left",t.opts.tableResizerOffset),Q.css("padding-right",t.opts.tableResizerOffset),Q.show()}else Q.hide()}}function V(){if(le){var e=Q.data("table");Q.css("top",e.offset().top-t.window.pageYOffset)}}function P(){var l=Q.data("origin"),a=Q.data("release-position");if(l!==a){var o=Q.data("first"),r=Q.data("second"),i=Q.data("table"),n=i.outerWidth();if(null!==o&&null!==r){var s,d,f,c=R(i),p=[],h=[],u=[],b=[];for(s=0;s<c.length;s++)d=e(c[s][o]),f=e(c[s][r]),p[s]=d.outerWidth(),u[s]=f.outerWidth(),h[s]=p[s]/n*100,b[s]=u[s]/n*100;for(s=0;s<c.length;s++){d=e(c[s][o]),f=e(c[s][r]);var m=(h[s]*(p[s]+a-l)/p[s]).toFixed(4);d.css("width",m+"%"),f.css("width",(h[s]+b[s]-m).toFixed(4)+"%")}}else{var g,v=i.parent(),w=n/v.width()*100;g=null==o?(n-a+l)/n*w:(n+a-l)/n*w,i.css("width",Math.round(g).toFixed(4)+"%")}}Q.removeData("origin"),Q.removeData("release-position"),Q.removeData("first"),Q.removeData("second"),Q.removeData("table"),t.undo.saveStep()}function K(t,l){var a,o=e(l[0][t]).outerWidth();for(a=1;a<l.length;a++)o=Math.min(o,e(l[a][t]).outerWidth());return o}function X(e,t,l){var a,o=0;for(a=e;t>=a;a++)o+=K(a,l);return o}function q(e){if(Z===!1&&le===!1)te&&clearTimeout(te),te=setTimeout(L,30,e);else if(le){var l=e.pageX-t.window.pageXOffset;t.opts.iframe&&(l+=t.$iframe.offset().left);var a=Q.data("max-left"),o=Q.data("max-right");l>=a&&o>=l?Q.css("left",l-t.opts.tableResizerOffset):a>l&&parseFloat(Q.css("left"),10)>a-t.opts.tableResizerOffset?Q.css("left",a-t.opts.tableResizerOffset):l>o&&parseFloat(Q.css("left"),10)<o-t.opts.tableResizerOffset&&Q.css("left",o-t.opts.tableResizerOffset)}}function U(l){t.node.isEmpty(l.get(0))?l.prepend(e.FroalaEditor.MARKERS):l.prepend(e.FroalaEditor.START_MARKER).append(e.FroalaEditor.END_MARKER)}function Y(l){var a=l.which;if(a==e.FroalaEditor.KEYCODE.TAB&&0===t.opts.tabSpaces){var o;if(t.$el.find(".fr-selected-cell").length>0)o=t.$el.find(".fr-selected-cell:last");else{var r=t.selection.element();"TD"==r.tagName||"TH"==r.tagName?o=e(r):e(r).closest("td").length>0?o=e(r).closest("td"):e(r).closest("th").length>0&&(o=e(r).closest("th"))}o&&(l.preventDefault(),I(),t.popups.hide("table.edit"),l.shiftKey?o.prev().length>0?U(o.prev()):o.closest("tr").length>0&&o.closest("tr").prev().length>0?U(o.closest("tr").prev().find("td:last")):o.closest("tbody").length>0&&o.closest("table").find("thead tr").length>0&&U(o.closest("table").find("thead tr th:last")):o.next().length>0?U(o.next()):o.closest("tr").length>0&&o.closest("tr").next().length>0?U(o.closest("tr").next().find("td:first")):o.closest("thead").length>0&&o.closest("table").find("tbody tr").length>0?U(o.closest("table").find("tbody tr td:first")):(o.addClass("fr-selected-cell"),m("below"),I(),U(o.closest("tr").next().find("td:first"))),t.selection.restore())}}function G(){return t.$wp?(t.helpers.isMobile()||(Z=!1,le=!1,W(),t.$el.on("mousedown.table"+t.id,T),t.popups.onShow("image.edit",function(){I(),Z=!1}),t.popups.onShow("link.edit",function(){I(),Z=!1}),t.events.on("commands.mousedown",function(e){e.parents(".fr-toolbar").length>0&&I()}),t.$el.on("mouseenter.table"+t.id,"th, td",j),t.$window.on("mouseup.table"+t.id,N),t.$el.on("keydown.table"+t.id,H),t.$window.on("mousemove.table"+t.id,q),e(t.window).on("scroll.table"+t.id,V),t.events.on("contentChanged",function(){t.$el.find(".fr-selected-cell").length>0&&(a(),t.$el.find("img").on("load.selected-cells",function(){e(this).off("load.selected-cells"),t.$el.find(".fr-selected-cell").length>0&&a()}))}),e(t.original_window).on("resize.table"+t.id,function(){I()}),e(t.window).on("keydown.table"+t.id,function(l){if(t.$el.find(".fr-selected-cell").length>0){if(l.which==e.FroalaEditor.KEYCODE.ESC)return I(),l.preventDefault(),l.stopPropagation(),l.stopImmediatePropagation(),!1;if(l.which==e.FroalaEditor.KEYCODE.BACKSPACE)return l.preventDefault(),!1;if(t.$el.find(".fr-selected-cell").length>1)return l.preventDefault(),!1}}),e(t.window).on("keydown.table"+t.id,a),e(t.window).on("input.table"+t.id,a),e(t.window).on("keyup.table"+t.id,a),t.events.on("html.get",function(e){return e=e.replace(/<(td|th)((?:[\w\W]*?))class="([\w\W]*?)fr-selected-cell([\w\W]*?)"((?:[\w\W]*?))>((?:[\w\W]*?))<\/(td|th)>/g,'<$1$2class="$3$4"$5>$6</$7>'),e=e.replace(/<(td|th)((?:[\w\W]*?)) class=""((?:[\w\W]*?))>((?:[\w\W]*?))<\/(td|th)>/g,"<$1$2$3>$4</$5>")}),t.events.on("destroy",function(){t.$el.off("mousedown.table"+t.id),t.$el.off("mouseenter.table"+t.id,"th, td"),t.$window.off("mouseup.table"+t.id),t.$el.off("keydown.table"+t.id),t.$window.off("mousemove.table"+t.id),e(t.window).off("scroll.table"+t.id),e(t.window).off("keydown.table"+t.id),e(t.window).off("input.table"+t.id),e(t.window).off("keyup.table"+t.id)},!0)),void t.events.on("keydown",Y,!0)):!1}function J(){t.$el.find(".fr-selected-cell").length>0?a():(t.popups.hide("table.insert"),t.toolbar.showInline())}var Q,Z,ee,te,le;return{_init:G,insert:p,remove:h,insertRow:m,deleteRow:g,insertColumn:v,deleteColumn:w,mergeCells:C,splitCellVertically:$,splitCellHorizontally:E,addHeader:u,removeHeader:b,setBackground:y,showInsertPopup:l,showEditPopup:a,showColorsPopup:o,back:J,verticalAlign:F,horizontalAlign:A,applyStyle:M}},e.FroalaEditor.DefineIcon("insertTable",{NAME:"table"}),e.FroalaEditor.RegisterCommand("insertTable",{title:"Insert Table",undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible("table.insert")?(this.$el.find(".fr-marker")&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("table.insert")):this.table.showInsertPopup()}}),e.FroalaEditor.RegisterCommand("tableInsert",{callback:function(e,t,l){this.table.insert(t,l),this.popups.hide("table.insert")}}),e.FroalaEditor.DefineIcon("tableHeader",{NAME:"header"}),e.FroalaEditor.RegisterCommand("tableHeader",{title:"Table Header",focus:!1,callback:function(){var e=this.popups.get("table.edit").find('.fr-command[data-cmd="tableHeader"]');e.hasClass("fr-active")?this.table.removeHeader():this.table.addHeader()},refresh:function(e){var t=this.$el.find(".fr-selected-cell").closest("table");t.length>0&&(0===t.find("th").length?e.removeClass("fr-active"):e.addClass("fr-active"))}}),e.FroalaEditor.DefineIcon("tableRows",{NAME:"bars"}),e.FroalaEditor.RegisterCommand("tableRows",{type:"dropdown",focus:!1,title:"Row",options:{above:"Insert row above",below:"Insert row below","delete":"Delete row"},html:function(){var t='<ul class="fr-dropdown-list">',l=e.FroalaEditor.COMMANDS.tableRows.options;for(var a in l)t+='<li><a class="fr-command" data-cmd="tableRows" data-param1="'+a+'" title="'+this.language.translate(l[a])+'">'+this.language.translate(l[a])+"</a></li>";return t+="</ul>"},callback:function(e,t){"above"==t||"below"==t?this.table.insertRow(t):this.table.deleteRow()}}),e.FroalaEditor.DefineIcon("tableColumns",{NAME:"bars fa-rotate-90"}),e.FroalaEditor.RegisterCommand("tableColumns",{type:"dropdown",focus:!1,title:"Column",options:{before:"Insert column before",after:"Insert column after","delete":"Delete column"},html:function(){var t='<ul class="fr-dropdown-list">',l=e.FroalaEditor.COMMANDS.tableColumns.options;for(var a in l)t+='<li><a class="fr-command" data-cmd="tableColumns" data-param1="'+a+'" title="'+this.language.translate(l[a])+'">'+this.language.translate(l[a])+"</a></li>";return t+="</ul>"},callback:function(e,t){"before"==t||"after"==t?this.table.insertColumn(t):this.table.deleteColumn()}}),e.FroalaEditor.DefineIcon("tableCells",{NAME:"square-o"}),e.FroalaEditor.RegisterCommand("tableCells",{type:"dropdown",focus:!1,title:"Cell",options:{merge:"Merge cells","vertical-split":"Vertical split","horizontal-split":"Horizontal split"},html:function(){var t='<ul class="fr-dropdown-list">',l=e.FroalaEditor.COMMANDS.tableCells.options;for(var a in l)t+='<li><a class="fr-command" data-cmd="tableCells" data-param1="'+a+'" title="'+this.language.translate(l[a])+'">'+this.language.translate(l[a])+"</a></li>";return t+="</ul>"},callback:function(e,t){"merge"==t?this.table.mergeCells():"vertical-split"==t?this.table.splitCellVertically():this.table.splitCellHorizontally()},refreshOnShow:function(e,t){this.$el.find(".fr-selected-cell").length>1?(t.find('a[data-param1="vertical-split"]').addClass("fr-disabled"),t.find('a[data-param1="horizontal-split"]').addClass("fr-disabled"),t.find('a[data-param1="merge"]').removeClass("fr-disabled")):(t.find('a[data-param1="merge"]').addClass("fr-disabled"),t.find('a[data-param1="vertical-split"]').removeClass("fr-disabled"),t.find('a[data-param1="horizontal-split"]').removeClass("fr-disabled"))}}),e.FroalaEditor.DefineIcon("tableRemove",{NAME:"trash"}),e.FroalaEditor.RegisterCommand("tableRemove",{title:"Remove Table",focus:!1,callback:function(){this.table.remove()}}),e.FroalaEditor.DefineIcon("tableStyle",{NAME:"paint-brush"}),e.FroalaEditor.RegisterCommand("tableStyle",{title:"Table Style",type:"dropdown",focus:!1,html:function(){var e='<ul class="fr-dropdown-list">',t=this.opts.tableStyles;for(var l in t)e+='<li><a class="fr-command" data-cmd="tableStyle" data-param1="'+l+'" title="'+this.language.translate(t[l])+'">'+this.language.translate(t[l])+"</a></li>";return e+="</ul>"},callback:function(e,t){this.table.applyStyle(t,this.$el.find(".fr-selected-cell").closest("table"),this.opts.tableMultipleStyles,this.opts.tableStyles)},refreshOnShow:function(t,l){var a=this.$el.find(".fr-selected-cell").closest("table");a&&l.find(".fr-command").each(function(){var t=e(this).data("param1");e(this).toggleClass("fr-active",a.hasClass(t))})}}),e.FroalaEditor.DefineIcon("tableCellBackground",{NAME:"tint"}),e.FroalaEditor.RegisterCommand("tableCellBackground",{title:"Cell Background",focus:!1,callback:function(){this.table.showColorsPopup()}}),e.FroalaEditor.RegisterCommand("tableCellBackgroundColor",{undo:!0,focus:!1,callback:function(e,t){this.table.setBackground(t)}}),e.FroalaEditor.DefineIcon("tableBack",{NAME:"arrow-left"}),e.FroalaEditor.RegisterCommand("tableBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.table.back()},refresh:function(e){0!==this.$el.find(".fr-selected-cell").length||this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),e.FroalaEditor.DefineIcon("tableCellVerticalAlign",{NAME:"arrows-v"}),e.FroalaEditor.RegisterCommand("tableCellVerticalAlign",{type:"dropdown",focus:!1,title:"Vertical Align",options:{Top:"Align Top",Middle:"Align Middle",Bottom:"Align Bottom"},html:function(){var t='<ul class="fr-dropdown-list">',l=e.FroalaEditor.COMMANDS.tableCellVerticalAlign.options;for(var a in l)t+='<li><a class="fr-command" data-cmd="tableCellVerticalAlign" data-param1="'+a.toLowerCase()+'" title="'+this.language.translate(l[a])+'">'+this.language.translate(a)+"</a></li>";return t+="</ul>"},callback:function(e,t){this.table.verticalAlign(t)},refreshOnShow:function(e,t){t.find('.fr-command[data-param1="'+this.$el.find(".fr-selected-cell").css("vertical-align")+'"]').addClass("fr-active")}}),e.FroalaEditor.DefineIcon("tableCellHorizontalAlign",{NAME:"align-left"}),e.FroalaEditor.DefineIcon("align-left",{NAME:"align-left"}),e.FroalaEditor.DefineIcon("align-right",{NAME:"align-right"}),e.FroalaEditor.DefineIcon("align-center",{NAME:"align-center"}),e.FroalaEditor.DefineIcon("align-justify",{NAME:"align-justify"}),e.FroalaEditor.RegisterCommand("tableCellHorizontalAlign",{type:"dropdown",focus:!1,title:"Horizontal Align",options:{left:"Align Left",center:"Align Center",right:"Align Right",justify:"Align Justify"},html:function(){var t='<ul class="fr-dropdown-list">',l=e.FroalaEditor.COMMANDS.tableCellHorizontalAlign.options;for(var a in l)t+='<li><a class="fr-command fr-title" data-cmd="tableCellHorizontalAlign" data-param1="'+a+'" title="'+this.language.translate(l[a])+'">'+this.icon.create("align-"+a)+"</a></li>";return t+="</ul>"},callback:function(e,t){this.table.horizontalAlign(t)},refresh:function(e){e.find("> *:first").replaceWith(this.icon.create("align-"+this.helpers.getAlignment(this.$el.find(".fr-selected-cell:first"))));
},refreshOnShow:function(e,t){t.find('.fr-command[data-param1="'+this.helpers.getAlignment(this.$el.find(".fr-selected-cell:first"))+'"]').addClass("fr-active")}}),e.FroalaEditor.DefineIcon("tableCellStyle",{NAME:"magic"}),e.FroalaEditor.RegisterCommand("tableCellStyle",{title:"Cell Style",type:"dropdown",focus:!1,html:function(){var e='<ul class="fr-dropdown-list">',t=this.opts.tableCellStyles;for(var l in t)e+='<li><a class="fr-command" data-cmd="tableCellStyle" data-param1="'+l+'" title="'+this.language.translate(t[l])+'">'+this.language.translate(t[l])+"</a></li>";return e+="</ul>"},callback:function(e,t){this.table.applyStyle(t,this.$el.find(".fr-selected-cell"),this.opts.tableCellMultipleStyles,this.opts.tableCellStyles)},refreshOnShow:function(t,l){var a=this.$el.find(".fr-selected-cell:first");a&&l.find(".fr-command").each(function(){var t=e(this).data("param1");e(this).toggleClass("fr-active",a.hasClass(t))})}})});