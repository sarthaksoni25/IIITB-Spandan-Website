/*!
 * froala_editor v2.0.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms
 * Copyright 2014-2015 Froala Labs
 */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){"use strict";e.extend(e.FroalaEditor.POPUP_TEMPLATES,{"video.insert":"[_BUTTONS_][_BY_URL_LAYER_][_EMBED_LAYER_]","video.edit":"[_BUTTONS_]","video.size":"[_BUTTONS_][_SIZE_LAYER_]"}),e.extend(e.FroalaEditor.DEFAULTS,{videoInsertButtons:["videoBack","|","videoByURL","videoEmbed"],videoEditButtons:["videoDisplay","videoAlign","videoSize","videoRemove"],videoResize:!0,videoSizeButtons:["videoBack","|"],videoTextNear:!0,videoDefaultAlign:"center",videoDefaultDisplay:"block"}),e.FroalaEditor.VIDEO_PROVIDERS=[{test_regex:/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=|embed\/)?([0-9a-zA-Z_\-]+)(.+)?/g,url_text:"//www.youtube.com/embed/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.*(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/))?([0-9]+)/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:vimeo\.com)\/(?:channels\/[A-z]+\/|groups\/[A-z]+\/videos\/)?(.+)/g,url_text:"//player.vimeo.com/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.+(dailymotion.com|dai.ly)\/(video|hub)?\/?([^_]+)[^#]*(#video=([^_&]+))?/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:dailymotion\.com|dai\.ly)\/(?:video|hub)?\/?(.+)/g,url_text:"//www.dailymotion.com/embed/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.+(screen.yahoo.com)\/[^_&]+/,url_regex:"",url_text:"",html:'<iframe width="640" height="360" src="{url}?format=embed" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"></iframe>'},{test_regex:/^.+(rutube.ru)\/[^_&]+/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:rutube\.ru)\/(?:video)?\/?(.+)/g,url_text:"//rutube.ru/play/embed/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"></iframe>'}],e.FroalaEditor.PLUGINS.video=function(t){function i(){var e=t.popups.get("video.insert"),i=e.find(".fr-video-by-url-layer input");i.val("").trigger("change");var o=e.find(".fr-video-embed-layer textarea");o.val("").trigger("change")}function o(){var e=t.$tb.find('.fr-command[data-cmd="insertVideo"]'),i=t.popups.get("video.insert");if(i||(i=s()),!i.hasClass("fr-active")){t.popups.refresh("video.insert"),t.popups.setContainer("video.insert",t.$tb);var o=e.offset().left+e.outerWidth()/2,r=e.offset().top+(t.opts.toolbarBottom?10:e.outerHeight()-10);t.popups.show("video.insert",o,r,e.outerHeight())}}function r(){var i=t.popups.get("video.edit");i||(i=x()),t.popups.setContainer("video.edit",e(t.opts.scrollableContainer)),t.popups.refresh("video.edit");var o=j.find("iframe, embed, video"),r=o.offset().left+o.outerWidth()/2,s=o.offset().top+o.outerHeight();t.popups.show("video.edit",r,s,o.outerHeight())}function s(){var e="";t.opts.videoInsertButtons.length>1&&(e='<div class="fr-buttons">'+t.button.buildList(t.opts.videoInsertButtons)+"</div>");var o="";t.opts.videoInsertButtons.indexOf("videoByURL")>=0&&(o='<div class="fr-video-by-url-layer fr-layer fr-active" id="fr-video-by-url-layer-'+t.id+'"><div class="fr-input-line"><input type="text" placeholder="http://" tabIndex="1"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoInsertByURL" tabIndex="2">'+t.language.translate("Insert")+"</button></div></div>");var r="";t.opts.videoInsertButtons.indexOf("videoEmbed")>=0&&(r='<div class="fr-video-embed-layer fr-layer" id="fr-video-embed-layer-'+t.id+'"><div class="fr-input-line"><textarea type="text" placeholder="'+t.language.translate("Embedded Code")+'" tabIndex="1" rows="5"></textarea></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoInsertEmbed" tabIndex="2">'+t.language.translate("Insert")+"</button></div></div>");var s={buttons:e,by_url_layer:o,embed_layer:r},n=t.popups.create("video.insert",s);return t.popups.onRefresh("video.insert",i),t.popups.onHide("video.insert",l),n}function n(e){var i,o,r=t.popups.get("video.insert");if(!j&&!t.opts.toolbarInline){var s=t.$tb.find('.fr-command[data-cmd="insertVideo"]');i=s.offset().left+s.outerWidth()/2,o=s.offset().top+(t.opts.toolbarBottom?10:s.outerHeight()-10)}t.opts.toolbarInline&&(o=r.offset().top-t.helpers.getPX(r.css("margin-top")),r.hasClass("fr-above")&&(o+=r.outerHeight())),r.find(".fr-layer").removeClass("fr-active"),r.find(".fr-"+e+"-layer").addClass("fr-active"),t.popups.show("video.insert",i,o,0)}function a(e){var i=t.popups.get("video.insert");i.find(".fr-video-by-url-layer").hasClass("fr-active")&&e.addClass("fr-active")}function d(e){var i=t.popups.get("video.insert");i.find(".fr-video-embed-layer").hasClass("fr-active")&&e.addClass("fr-active")}function l(){}function f(e){t.events.focus(!0),t.selection.restore(),t.html.insert('<span contenteditable="false" class="fr-jiv fr-video fr-dv'+t.opts.videoDefaultDisplay[0]+("center"!=t.opts.videoDefaultAlign?" fr-fv"+t.opts.videoDefaultAlign[0]:"")+'">'+e+"</span>"),t.popups.hide("video.insert");var i=t.$el.find(".fr-jiv");i.removeClass("fr-jiv"),t.events.trigger("video.inserted",[i])}function v(i){if("undefined"==typeof i){var o=t.popups.get("video.insert");i=o.find('.fr-video-by-url-layer input[type="text"]').val()||""}var r=null;if(t.helpers.isURL(i))for(var s=0;s<e.FroalaEditor.VIDEO_PROVIDERS.length;s++){var n=e.FroalaEditor.VIDEO_PROVIDERS[s];if(n.test_regex.test(i)){r=i.replace(n.url_regex,n.url_text),r=n.html.replace(/\{url\}/,r);break}}r?f(r):t.events.trigger("video.linkError",[i])}function u(e){if("undefined"==typeof e){var i=t.popups.get("video.insert");e=i.find(".fr-video-embed-layer textarea").val()||""}0===e.length?t.events.trigger("video.codeError",[e]):f(e)}function c(i){i.preventDefault(),i.stopPropagation();var o=i.pageX||(i.originalEvent.touches?i.originalEvent.touches[0].pageX:null),r=i.pageY||(i.originalEvent.touches?i.originalEvent.touches[0].pageY:null);return o&&r?(T=e(this),T.data("start-x",o),T.data("start-y",r),N.show(),void t.popups.hideAll()):!1}function p(e){if(T){e.preventDefault();var t=e.pageX||(e.originalEvent.touches?e.originalEvent.touches[0].pageX:null),i=e.pageY||(e.originalEvent.touches?e.originalEvent.touches[0].pageY:null);if(!t||!i)return!1;var o=T.data("start-x"),r=T.data("start-y");T.data("start-x",t),T.data("start-y",i);var s=t-o,n=i-r,a=j.find("iframe, embed, video"),d=a.width(),l=a.height();(T.hasClass("fr-hnw")||T.hasClass("fr-hsw"))&&(s=0-s),(T.hasClass("fr-hnw")||T.hasClass("fr-hne"))&&(n=0-n),a.css("width",d+s),a.css("height",l+n),a.removeAttr("width"),a.removeAttr("height"),b()}}function h(e){T&&(e&&e.preventDefault(),T=null,N.hide(),b(),r())}function m(e){return'<div class="fr-handler fr-h'+e+'"></div>'}function g(){if(M=e('<div class="fr-video-resizer"></div>'),t.$wp.append(M),e(t.original_window).on("resize.video"+t.id,y),t.events.on("destroy",function(){M.html("").removeData().remove(),e(t.original_window).off("resize.video"+t.id)},!0),t.opts.videoResize){M.append(m("nw")+m("ne")+m("sw")+m("se"));var i=M.get(0).ownerDocument;M.on(t._mousedown+".vidresize"+t.id,".fr-handler",c),e(i).on(t._mousemove+".vidresize"+t.id,p),e(i.defaultView||i.parentWindow).on(t._mouseup+".vidresize"+t.id,h),N=e('<div class="fr-video-overlay"></div>'),e(i).find("body").append(N),N.on("mouseleave",h),t.events.on("destroy",function(){M.off(t._mousedown+".vidresize"+t.id),e(i).off(t._mousemove+".vidresize"+t.id),e(i.defaultView||i.parentWindow).off(t._mouseup+".vidresize"+t.id),N.off("mouseleave").remove()},!0)}}function b(){M||g();var e=j.find("iframe, embed, video");M.css("top",(t.opts.iframe?e.offset().top-1:e.offset().top-t.$wp.offset().top-1)+t.$wp.scrollTop()).css("left",(t.opts.iframe?e.offset().left-1:e.offset().left-t.$wp.offset().left-1)+t.$wp.scrollLeft()).css("width",e.outerWidth()).css("height",e.height()).addClass("fr-active")}function w(i){return i&&"touchend"==i.type&&Y?!0:(i.preventDefault(),i.stopPropagation(),t.edit.isDisabled()?!1:(i.stopPropagation(),t.toolbar.disable(),t.helpers.isMobile()&&(t.events.disableBlur(),t.$el.blur(),t.events.enableBlur()),j=e(this),e(this).addClass("fr-active"),t.opts.iframe&&t.size.syncIframe(),b(),r(),t.selection.clear(),t.button.bulkRefresh(),void t.events.trigger("image.hideResizer")))}function y(e){e===!0&&(H=!0),j&&H&&(M.removeClass("fr-active"),t.toolbar.enable(),j.removeClass("fr-active"),j=null),H=!1}function E(){H=!0}function C(){H=!1}function _(){t.events.on("mousedown",E),t.events.on("window.mousedown",E),t.events.on("window.touchmove",C),t.events.on("mouseup",y),t.events.on("window.mouseup",y),t.events.on("commands.mousedown",function(e){e.parents(".fr-toolbar").length>0&&y()}),t.events.on("video.hideResizer",function(){y(!0)}),t.events.on("commands.undo",function(){y(!0)}),t.events.on("commands.redo",function(){y(!0)})}function x(){var e="";t.opts.videoEditButtons.length>1&&(e+='<div class="fr-buttons">',e+=t.button.buildList(t.opts.videoEditButtons),e+="</div>");var i={buttons:e},o=t.popups.create("video.edit",i);return t.$wp.on("scroll.video-edit",function(){j&&t.popups.isVisible("video.edit")&&r()}),t.events.on("destroy",function(){t.$wp.off("scroll.video-edit")}),o}function R(){if(j){var e=t.popups.get("video.size"),i=j.find("iframe, embed, video");e.find('input[name="width"]').val(i.get(0).style.width||i.attr("width")).trigger("change"),e.find('input[name="height"]').val(i.get(0).style.height||i.attr("height")).trigger("change")}}function z(){var i=t.popups.get("video.size");i||(i=I()),t.popups.refresh("video.size"),t.popups.setContainer("video.size",e(t.opts.scrollableContainer));var o=j.find("iframe, embed, video"),r=o.offset().left+o.width()/2,s=o.offset().top+o.height();t.popups.show("video.size",r,s,o.height())}function I(){var e="";e='<div class="fr-buttons">'+t.button.buildList(t.opts.videoSizeButtons)+"</div>";var i="";i='<div class="fr-video-size-layer fr-layer fr-active" id="fr-video-size-layer-'+t.id+'"><div class="fr-video-group"><div class="fr-input-line"><input type="text" name="width" placeholder="'+t.language.translate("Width")+'" tabIndex="1"></div><div class="fr-input-line"><input type="text" name="height" placeholder="'+t.language.translate("Height")+'" tabIndex="1"></div></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoSetSize" tabIndex="2">'+t.language.translate("Update")+"</button></div></div>";var o={buttons:e,size_layer:i},r=t.popups.create("video.size",o);return t.popups.onRefresh("video.size",R),t.$wp.on("scroll.video-size",function(){j&&t.popups.isVisible("video.size")&&z()}),t.events.on("destroy",function(){t.$wp.off("scroll.video-size")}),r}function D(e){j.removeClass("fr-fvr fr-fvl"),"left"==e?j.addClass("fr-fvl"):"right"==e&&j.addClass("fr-fvr"),b(),r()}function A(e){j.hasClass("fr-fvl")?e.find("> i").attr("class","fa fa-align-left"):j.hasClass("fr-fvr")?e.find("> i").attr("class","fa fa-align-right"):e.find("> i").attr("class","fa fa-align-justify")}function B(e,t){var i="justify";j.hasClass("fr-fvl")?i="left":j.hasClass("fr-fvr")&&(i="right"),t.find('.fr-command[data-param1="'+i+'"]').addClass("fr-active")}function k(e){j.removeClass("fr-dvi fr-dvb"),"inline"==e?j.addClass("fr-dvi"):"block"==e&&j.addClass("fr-dvb"),b(),r()}function S(e,t){var i="block";j.hasClass("fr-dvi")&&(i="inline"),t.find('.fr-command[data-param1="'+i+'"]').addClass("fr-active")}function F(){if(j&&t.events.trigger("video.beforeRemove",[j])!==!1){var e=j;t.popups.hideAll(),y(!0),t.selection.setBefore(e.get(0))||t.selection.setAfter(e.get(0)),e.remove(),t.selection.restore(),t.html.fillEmptyBlocks(!0),t.events.trigger("video.removed",[e])}}function L(e){if(!e.hasClass("fr-dvi")&&!e.hasClass("fr-dvb")){var i=e.css("float");e.css("float","none"),"block"==e.css("display")?(e.css("float",i),0===parseInt(e.css("margin-left"),10)&&(e.attr("style")||"").indexOf("margin-right: auto")>=0?e.addClass("fr-fvl"):0===parseInt(e.css("margin-right"),10)&&(e.attr("style")||"").indexOf("margin-left: auto")>=0&&e.addClass("fr-fvr"),e.addClass("fr-dvb")):(e.css("float",i),"left"==e.css("float")?e.addClass("fr-fvl"):"right"==e.css("float")&&e.addClass("fr-fvr"),e.addClass("fr-dvi")),e.css("margin",""),e.css("float",""),e.css("display",""),e.css("z-index",""),e.css("position",""),e.css("overflow",""),e.css("vertical-align","")}t.opts.videoTextNear||e.removeClass("fr-dvi").addClass("fr-dvb")}function O(){t.$el.find("video").filter(function(){return 0===e(this).parents("span.fr-video").length}).wrap('<span class="fr-video" contenteditable="false"></span>'),t.$el.find("embed, iframe").filter(function(){if(t.browser.safari&&this.getAttribute("src")&&this.setAttribute("src",this.src),e(this).parents("span.fr-video").length>0)return!1;for(var i=e(this).attr("src"),o=0;o<e.FroalaEditor.VIDEO_PROVIDERS.length;o++){var r=e.FroalaEditor.VIDEO_PROVIDERS[o];if(r.test_regex.test(i))return!0}return!1}).map(function(){return 0===e(this).parents("object").length?this:e(this).parents("object").get(0)}).wrap('<span class="fr-video" contenteditable="false"></span>');for(var i=t.$el.find("span.fr-video"),o=0;o<i.length;o++)L(e(i[o]))}function $(){_(),t.helpers.isMobile()&&(t.$el.on("touchstart","span.fr-video",function(){Y=!1}),t.$el.on("touchmove",function(){Y=!0})),t.events.on("html.set",O),O(),t.$el.on("mousedown","span.fr-video",function(e){e.stopPropagation()}),t.$el.on("click touchend","span.fr-video",w),t.events.on("keydown",function(i){var o=i.which;return!j||o!=e.FroalaEditor.KEYCODE.BACKSPACE&&o!=e.FroalaEditor.KEYCODE.DELETE?j&&o==e.FroalaEditor.KEYCODE.ESC?(y(!0),i.preventDefault(),!1):j&&!t.keys.ctrlKey(i)?(i.preventDefault(),!1):void 0:(i.preventDefault(),F(),!1)},!0),t.events.on("keydown",function(){t.$el.find("span.fr-video:empty").remove()})}function P(){j?j.trigger("click"):(t.popups.hide("video.insert"),t.toolbar.showInline())}function U(e,i){if(j){var o=t.popups.get("video.size"),r=j.find("iframe, embed, video");r.css("width",e||o.find('input[name="width"]').val()),r.css("height",i||o.find('input[name="height"]').val()),r.get(0).style.width&&r.removeAttr("width"),r.get(0).style.height&&r.removeAttr("height"),o.find("input").blur(),setTimeout(function(){j.trigger("click")},t.helpers.isAndroid()?50:0)}}function V(){return j}var N,T,M,j,Y,H=!1;return{_init:$,showInsertPopup:o,showLayer:n,refreshByURLButton:a,refreshEmbedButton:d,insertByURL:v,insertEmbed:u,insert:f,align:D,refreshAlign:A,refreshAlignOnShow:B,display:k,refreshDisplayOnShow:S,remove:F,showSizePopup:z,back:P,setSize:U,get:V}},e.FroalaEditor.RegisterCommand("insertVideo",{title:"Insert Video",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("video.insert")?(this.$el.find(".fr-marker")&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("video.insert")):this.video.showInsertPopup()}}),e.FroalaEditor.DefineIcon("insertVideo",{NAME:"video-camera"}),e.FroalaEditor.DefineIcon("videoByURL",{NAME:"link"}),e.FroalaEditor.RegisterCommand("videoByURL",{title:"By URL",undo:!1,focus:!1,callback:function(){this.video.showLayer("video-by-url")},refresh:function(e){this.video.refreshByURLButton(e)}}),e.FroalaEditor.DefineIcon("videoEmbed",{NAME:"code"}),e.FroalaEditor.RegisterCommand("videoEmbed",{title:"Embedded Code",undo:!1,focus:!1,callback:function(){this.video.showLayer("video-embed")},refresh:function(e){this.video.refreshEmbedButton(e)}}),e.FroalaEditor.RegisterCommand("videoInsertByURL",{undo:!0,focus:!0,callback:function(){this.video.insertByURL()}}),e.FroalaEditor.RegisterCommand("videoInsertEmbed",{undo:!0,focus:!0,callback:function(){this.video.insertEmbed()}}),e.FroalaEditor.DefineIcon("videoDisplay",{NAME:"star"}),e.FroalaEditor.RegisterCommand("videoDisplay",{title:"Display",type:"dropdown",options:{inline:"Inline",block:"Break Text"},callback:function(e,t){this.video.display(t)},refresh:function(e){this.opts.videoTextNear||e.addClass("fr-hidden")},refreshOnShow:function(e,t){this.video.refreshDisplayOnShow(e,t)}}),e.FroalaEditor.DefineIcon("videoAlign",{NAME:"align-center"}),e.FroalaEditor.RegisterCommand("videoAlign",{type:"dropdown",title:"Align",options:{left:"Align Left",justify:"None",right:"Align Right"},html:function(){var t='<ul class="fr-dropdown-list">',i=e.FroalaEditor.COMMANDS.videoAlign.options;for(var o in i)t+='<li><a class="fr-command fr-title" data-cmd="videoAlign" data-param1="'+o+'" title="'+this.language.translate(i[o])+'"><i class="fa fa-align-'+o+'"></i></a></li>';return t+="</ul>"},callback:function(e,t){this.video.align(t)},refresh:function(e){this.video.refreshAlign(e)},refreshOnShow:function(e,t){this.video.refreshAlignOnShow(e,t)}}),e.FroalaEditor.DefineIcon("videoRemove",{NAME:"trash"}),e.FroalaEditor.RegisterCommand("videoRemove",{title:"Remove",callback:function(){this.video.remove()}}),e.FroalaEditor.DefineIcon("videoSize",{NAME:"arrows-alt"}),e.FroalaEditor.RegisterCommand("videoSize",{undo:!1,focus:!1,title:"Change Size",callback:function(){this.video.showSizePopup()}}),e.FroalaEditor.DefineIcon("videoBack",{NAME:"arrow-left"}),e.FroalaEditor.RegisterCommand("videoBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.video.back()},refresh:function(e){var t=this.video.get();t||this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),e.FroalaEditor.RegisterCommand("videoSetSize",{undo:!0,focus:!1,callback:function(){this.video.setSize()}})});